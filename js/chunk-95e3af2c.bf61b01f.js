(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-95e3af2c"],{"09e2":function(e,t,s){"use strict";s("8aee")},"4cce":function(e,t,s){"use strict";var r=s("2fa3"),a=function(){return localStorage.getItem("token")};t["a"]={getCurrentUser:function(){return r["b"].get("/get-current-user",{headers:{Authorization:"Bearer ".concat(a())}})},get:function(e){var t=e.userId;return r["b"].get("/users/".concat(t),{headers:{Authorization:"Bearer ".concat(a())}})},update:function(e){var t=e.userId,s=e.formData;return r["b"].put("/users/".concat(t),s,{headers:{Authorization:"Bearer ".concat(a())}})},getTopUsers:function(){return r["b"].get("users/top",{headers:{Authorization:"Bearer ".concat(a())}})},getUserTweets:function(e){var t=e.userId;return r["b"].get("/users/".concat(t,"/tweets"),{headers:{Authorization:"Bearer ".concat(a())}})},getUserReplies:function(e){var t=e.userId;return r["b"].get("/users/".concat(t,"/replied_tweets"),{headers:{Authorization:"Bearer ".concat(a())}})},getUserLikes:function(e){var t=e.userId;return r["b"].get("/users/".concat(t,"/likes"),{headers:{Authorization:"Bearer ".concat(a())}})},getUserFollowers:function(e){var t=e.userId;return r["b"].get("/users/".concat(t,"/followers"),{headers:{Authorization:"Bearer ".concat(a())}})},getUserFollowings:function(e){var t=e.userId;return r["b"].get("/users/".concat(t,"/followings"),{headers:{Authorization:"Bearer ".concat(a())}})}}},"8aee":function(e,t,s){},c03c:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"self-like-list"}},[e.isLoading?r("Spinner"):e._l(e.likes,(function(t){return r("div",{key:t.index,staticClass:"like"},[r("router-link",{attrs:{to:{name:"user",params:{id:t.User.id}}}},[r("div",{staticClass:"avatar"},[r("div",{staticClass:"avatar-img"},[r("img",{attrs:{src:e._f("emptyImage")(t.User.avatar),alt:""}})])])]),r("div",{staticClass:"like-main"},[r("router-link",{attrs:{to:{name:"Reply",params:{id:t.TweetId}}}},[r("div",{staticClass:"like-user-info"},[r("div",{staticClass:"name"},[e._v(e._s(t.User.name))]),r("div",{staticClass:"account"},[e._v(" @"+e._s(t.User.account)),r("span",[e._v("‧"+e._s(e._f("fromNow")(t.createdAt)))])])]),r("div",{staticClass:"like-content scrollbar"},[e._v(" "+e._s(t.description)+" ")])]),r("div",{staticClass:"like-status"},[r("div",{staticClass:"replies state"},[r("img",{staticClass:"replies-img",attrs:{src:s("b74f"),alt:"chat-icon"},on:{click:function(s){return e.clickChatBtn(t.TweetId)}}}),r("div",{staticClass:"replies-count count"},[e._v(e._s(t.RepliesCount))])]),r("div",{staticClass:"likes state"},[t.isliked?r("img",{staticClass:"likes-img",attrs:{src:s("4167"),alt:"heart-icon",disabled:e.isProcessing},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),e.removeLike(t)}}}):r("img",{staticClass:"likes-img",attrs:{src:s("b4af"),alt:"heart-icon",disabled:e.isProcessing},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),e.addLike(t)}}}),r("div",{staticClass:"likes-count count"},[e._v(e._s(t.LikesCount))])])])],1)],1)})),r("ReplyModal",{attrs:{ReplyModalSwitch:e.ReplyModal,tweet:e.tweet},on:{"after-click-background":e.afterClickClose,"after-click-close":e.afterClickClose,"after-tweetReply-post":e.afterTweetReplyPost}})],2)},a=[],i=s("1da1"),n=(s("96cf"),s("a9e3"),s("7db0"),s("2375")),o=s("2797"),c=s("2708"),l=s("4cce"),u=s("2fa3"),d=s("7482"),f={mixins:[c["b"],c["a"]],components:{ReplyModal:o["a"],Spinner:n["a"]},data:function(){return{likes:[],tweet:{User:{avatar:""}},ReplyModal:!1,userId:Number(this.$route.params.id),isProcessing:!1,isLoading:!0}},created:function(){this.fetchUserLikes(this.userId)},beforeRouteUpdate:function(e,t,s){console.log(e,t);var r=e.params.id;this.fetchUserLikes(r),s()},methods:{fetchUserLikes:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var r,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,t.isLoading=!0,s.next=4,l["a"].getUserLikes({userId:e});case 4:r=s.sent,a=r.data,console.log("fetchUserLikes",a),t.likes=a,console.log("likes",t.likes),t.isLoading=!1,s.next=16;break;case 12:s.prev=12,s.t0=s["catch"](0),t.isLoading=!1,u["a"].fire({icon:"error",title:"無法取得推文，請稍後再試"});case 16:case"end":return s.stop()}}),s,null,[[0,12]])})))()},addLike:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var r,a,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return console.log("like",e),s.prev=1,t.isProcessing=!0,r=e.TweetId,s.next=6,d["a"].addLike({tweetId:r});case 6:if(a=s.sent,i=a.data,console.log("add data",i),"success"===i.status){s.next=11;break}throw new Error(i.message);case 11:e.LikesCount+=1,e.isliked=!0,t.isProcessing=!1,s.next=21;break;case 16:s.prev=16,s.t0=s["catch"](1),t.isProcessing=!1,console.log(s.t0),u["a"].fire({icon:"error",title:"無法喜歡,請稍後在試"});case 21:case"end":return s.stop()}}),s,null,[[1,16]])})))()},removeLike:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var r,a,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return console.log("like",e),s.prev=1,t.isProcessing=!0,r=e.TweetId,s.next=6,d["a"].removeLike({tweetId:r});case 6:if(a=s.sent,console.log("delete reponse",a),i=a.data,"success"===i.status){s.next=11;break}throw new Error(i.message);case 11:e.isliked=!1,e.LikesCount-=1,t.isProcessing=!1,s.next=21;break;case 16:s.prev=16,s.t0=s["catch"](1),t.isProcessing=!1,console.log(s.t0),u["a"].fire({icon:"error",title:"無法取消喜歡,請稍後在試"});case 21:case"end":return s.stop()}}),s,null,[[1,16]])})))()},clickChatBtn:function(e){this.ReplyModal=!0;var t=this.likes.find((function(t){return t.TweetId===e}));this.tweet=t,console.log("clickBtn tweet",this.tweet),console.log("clickBtn modalTweet",t)},afterClickClose:function(){this.ReplyModal=!1},afterTweetReplyPost:function(){this.ReplyModal=!1,this.$emit("after-tweetReply-post"),this.fetchUserLikes(this.userId)}}},g=f,k=(s("09e2"),s("2877")),p=Object(k["a"])(g,r,a,!1,null,"e16bac24",null);t["default"]=p.exports}}]);
//# sourceMappingURL=chunk-95e3af2c.bf61b01f.js.map