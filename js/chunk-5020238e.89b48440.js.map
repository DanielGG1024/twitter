{"version":3,"sources":["webpack:///./src/views/UserFollower.vue?a804","webpack:///./src/components/UserFollowTab.vue?892d","webpack:///./src/views/UserFollower.vue?0479","webpack:///src/views/UserFollower.vue","webpack:///./src/views/UserFollower.vue?5b6f","webpack:///./src/views/UserFollower.vue?6695","webpack:///./src/components/UserFollowTab.vue?f14f","webpack:///./src/components/UserFollowTab.vue?dc16"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","userId","currentUserId","user","_l","follower","key","followerId","_f","avatar","_v","_s","name","account","introduction","isProcessing","on","$event","removeFollow","addFollow","topUsers","followClicked","directives","rawName","value","noLength","expression","staticRenderFns","mixins","components","UserLeftColumn","UserRightColumn","UserHeader","UserFollowTab","Spinner","data","isLoading","Number","$route","params","id","followers","created","fetchFollower","fetchUserInfo","fetchTopUsers","computed","beforeRouteUpdate","next","methods","map","component","class","clicked","script"],"mappings":"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","file":"js/chunk-5020238e.89b48440.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserFollower.vue?vue&type=style&index=0&id=f5460dde&lang=scss&scoped=true&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserFollowTab.vue?vue&type=style&index=0&id=3472e1b4&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"window demo\"},[_c('div',{staticClass:\"user\"},[_c('UserLeftColumn',{attrs:{\"userId\":_vm.userId,\"currentUserId\":_vm.currentUserId}}),(_vm.isLoading)?_c('Spinner',{staticClass:\"user-spinner\"}):_c('div',{staticClass:\"center-column scrollbar\",attrs:{\"id\":\"center-column\"}},[_c('UserHeader',{attrs:{\"user\":_vm.user}}),_c('UserFollowTab'),_c('div',{staticClass:\"user-follower-list \"},[_c('div',{staticClass:\"user-followers\"},_vm._l((_vm.followers),function(follower){return _c('div',{key:follower.followerId,staticClass:\"follower\"},[_c('div',{staticClass:\"avatar\"},[_c('div',{staticClass:\"avatar-img\"},[_c('img',{attrs:{\"src\":_vm._f(\"emptyImage\")(follower.avatar),\"alt\":\"avatar\"}})])]),_c('div',{staticClass:\"follower-main\"},[_c('div',{staticClass:\"name\"},[_vm._v(_vm._s(follower.name))]),_c('div',{staticClass:\"tag-name\"},[_vm._v(\"@\"+_vm._s(follower.account))]),_c('div',{staticClass:\"description\"},[_vm._v(\" \"+_vm._s(follower.introduction)+\" \")])]),(follower.isFollowed)?_c('button',{staticClass:\"follower-btn following\",attrs:{\"disabled\":_vm.isProcessing},on:{\"click\":function($event){return _vm.removeFollow(follower)}}},[_vm._v(\" 正在跟隨 \")]):_c('button',{staticClass:\"follower-btn\",attrs:{\"disabled\":_vm.isProcessing},on:{\"click\":function($event){return _vm.addFollow(follower)}}},[_vm._v(\" 跟隨 \")])])}),0)])],1),_c('UserRightColumn',{attrs:{\"initialTopUsers\":_vm.topUsers},on:{\"add-follow-click\":_vm.followClicked,\"remove-follow-click\":_vm.followClicked}})],1),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.noLength === true),expression:\"noLength === true\"}],staticClass:\"noLength\"},[_vm._v(\" 尚未有人追隨 \")])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"window demo\">\n    <div class=\"user\">\n      <!-- left Column -->\n      <UserLeftColumn :userId=\"userId\" :currentUserId=\"currentUserId\" />\n      <!-- center column -->\n      <Spinner v-if=\"isLoading\" class=\"user-spinner\" />\n      <div v-else id=\"center-column\" class=\"center-column scrollbar\">\n        <!-- header -->\n        <UserHeader :user=\"user\" />\n\n        <!-- follower/following -->\n        <UserFollowTab />\n        <div class=\"user-follower-list \">\n          <div class=\"user-followers\">\n            <div\n              class=\"follower\"\n              v-for=\"follower in followers\"\n              :key=\"follower.followerId\"\n            >\n              <div class=\"avatar\">\n                <div class=\"avatar-img\">\n                  <img\n                    :src=\"follower.avatar | emptyImage\"\n                    alt=\"avatar\"\n                    class=\"\"\n                  />\n                </div>\n              </div>\n              <div class=\"follower-main\">\n                <div class=\"name\">{{ follower.name }}</div>\n                <div class=\"tag-name\">@{{ follower.account }}</div>\n                <div class=\"description\">\n                  {{ follower.introduction }}\n                </div>\n              </div>\n              <button\n                class=\"follower-btn following\"\n                v-if=\"follower.isFollowed\"\n                @click=\"removeFollow(follower)\"\n                :disabled=\"isProcessing\"\n              >\n                正在跟隨\n              </button>\n              <button\n                class=\"follower-btn\"\n                v-else\n                @click=\"addFollow(follower)\"\n                :disabled=\"isProcessing\"\n              >\n                跟隨\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n      <!-- right Column -->\n\n      <UserRightColumn\n        :initialTopUsers=\"topUsers\"\n        @add-follow-click=\"followClicked\"\n        @remove-follow-click=\"followClicked\"\n      />\n    </div>\n    <div v-show=\"noLength === true\" class=\"noLength\">\n      尚未有人追隨\n    </div>\n  </div>\n</template>\n\n<script>\nimport UserLeftColumn from \"../components/UserLeftColumn.vue\";\nimport UserRightColumn from \"../components/UserRightColumn.vue\";\n\nimport UserHeader from \"../components/UserHeader.vue\";\nimport UserFollowTab from \"../components/UserFollowTab.vue\";\nimport Spinner from \"../components/Spinner.vue\";\n\nimport usersAPI from \"../apis/users\";\nimport tweetAPI from \"../apis/tweet\";\nimport { Toast } from \"./../utils/helpers\";\nimport { mapState } from \"vuex\";\nimport { fromNowFilter, emptyImageFilter } from \"./../utils/mixins\";\n\nexport default {\n  mixins: [fromNowFilter, emptyImageFilter],\n  components: {\n    UserLeftColumn,\n    UserRightColumn,\n    UserHeader,\n    // Popular,\n    UserFollowTab,\n    Spinner,\n  },\n  data() {\n    return {\n      isLoading: true,\n      userId: Number(this.$route.params.id),\n      currentUserId: -1,\n      user: {},\n      topUsers: [],\n      followers: [],\n      isProcessing: false,\n      noLength: false,\n    };\n  },\n\n  created() {\n    this.fetchFollower(this.userId);\n    this.fetchUserInfo(this.userId);\n    this.fetchTopUsers();\n  },\n  computed: {\n    ...mapState([\"currentUser\", \"isAuthenticated\"]),\n  },\n  beforeRouteUpdate(to, from, next) {\n    // 路由改變時重新抓取資料\n    const { id } = to.params;\n    this.fetchFollower(id);\n    this.userId = Number(id);\n    next();\n  },\n\n  methods: {\n    async fetchFollower(userId) {\n      try {\n        this.isLoading = true;\n        const { data } = await usersAPI.getUserFollowers({ userId });\n        this.followers = data;\n        this.isLoading = false;\n        if (this.followers.length === 0) {\n          this.noLength = true;\n        }\n      } catch (error) {\n        console.log(error);\n        (this.isLoading = false),\n          Toast.fire({\n            icon: \"error\",\n            title: \"無法取得個人資料，請稍後再試\",\n          });\n      }\n    },\n    async fetchUserInfo(userId) {\n      try {\n        this.isLoading = true;\n        const { data } = await usersAPI.get({ userId });\n        this.user = data;\n        this.isLoading = false;\n      } catch (error) {\n        (this.isLoading = false),\n          Toast.fire({\n            icon: \"error\",\n            title: \"無法取得個人資料，請稍後再試\",\n          });\n      }\n    },\n    async fetchTopUsers() {\n      try {\n        const response = await tweetAPI.getTopUser();\n        const { data } = response;\n        this.topUsers = data;\n      } catch {\n        Toast.fire({\n          icon: \"warning\",\n          title: \"無法取得前十\",\n        });\n      }\n    },\n\n    async addFollow(follower) {\n      const userId = follower.followerId\n      const data = `{\n        \"id\":\"${userId}\"\n      }`;\n      const data_JSON = JSON.parse(data);\n      try {\n        this.isProcessing = true;\n        const response = await tweetAPI.addFollow({ data_JSON });\n        console.log(\"popular response\", response);\n        follower.isFollowed = true\n\n        this.topUsers.map((topUser) => {\n          if (userId !== topUser.id) {\n            return;\n          } else if (userId === topUser.id) {\n            topUser.isFollowed = true;\n          }\n        });\n\n        this.isProcessing = false;\n      } catch {\n        this.isProcessing = false;\n        Toast.fire({\n          icon: \"error\",\n          title: \"無法追蹤使用者,請稍後\",\n        });\n      }\n    },\n\n    async removeFollow(follower) {\n      const userId = follower.followerId\n      try {\n        this.isProcessing = true;\n        const response = await tweetAPI.removeFollow({ userId });\n        const { data } = response;\n        if (data.status !== \"success\") {\n          throw new Error(data.message);\n        }\n\n        \n\n        this.followers = this.followers.map((follower) => {\n          if (follower.id !== userId) {\n            return follower;\n          }\n          return {\n            ...follower,\n            isfollowered: false,\n          };\n        });\n\n        follower.isFollowed = false\n\n        this.topUsers.map((topUser) => {\n          if (userId !== topUser.id) {\n            return;\n          } else if (userId === topUser.id) {\n            topUser.isFollowed = false;\n          }\n        });\n\n        // this.fetchFollower(this.userId);\n        this.isProcessing = false;\n      } catch (error) {\n        this.isProcessing = false;\n        console.log(error);\n        Toast.fire({\n          icon: \"error\",\n          title: \"無法取消喜歡,請稍後在試\",\n        });\n      }\n    },\n\n    followClicked(userId) {\n      this.followers.map((follower) => {\n          if (userId !== follower.followerId) {\n            return;\n          } else if (userId === follower.followerId) {\n            follower.isFollowed = !follower.isFollowed \n          }\n        });\n    }\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"@/assets/scss/user.scss\";\n@import \"@/assets/scss/userFollower.scss\";\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserFollower.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserFollower.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserFollower.vue?vue&type=template&id=f5460dde&scoped=true&\"\nimport script from \"./UserFollower.vue?vue&type=script&lang=js&\"\nexport * from \"./UserFollower.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UserFollower.vue?vue&type=style&index=0&id=f5460dde&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f5460dde\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"user-follow-tab\"}},[_c('router-link',{attrs:{\"to\":{ name: 'follower' }}},[_c('div',{staticClass:\"follower tab\",class:{clicked: this.$route.name === 'follower'}},[_vm._v(\"跟隨者\")])]),_c('router-link',{attrs:{\"to\":{ name: 'following' }}},[_c('div',{staticClass:\"following tab\",class:{clicked: this.$route.name === 'following'}},[_vm._v(\"正在跟隨\")])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./UserFollowTab.vue?vue&type=template&id=3472e1b4&scoped=true&\"\nvar script = {}\nimport style0 from \"./UserFollowTab.vue?vue&type=style&index=0&id=3472e1b4&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3472e1b4\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}