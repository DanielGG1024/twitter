(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-30d1b367"],{2889:function(e,t,r){"use strict";r("f66c")},7384:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"window demo"},[r("div",{staticClass:"user"},[r("UserLeftColumn",{attrs:{userId:e.userId,currentUserId:e.currentUserId}}),e.isLoading?r("Spinner",{staticClass:"user-spinner"}):r("div",{staticClass:"center-column",attrs:{id:"center-column"}},[r("UserHeader",{attrs:{user:e.user}}),r("UserFollowTab"),r("div",{attrs:{id:"user-follower-list"}},[r("div",{staticClass:"user-followers"},e._l(e.followers,(function(t){return r("div",{key:t.followerId,staticClass:"follower"},[r("div",{staticClass:"avatar"},[r("div",{staticClass:"avatar-img"},[r("img",{attrs:{src:e._f("emptyImage")(t.avatar),alt:"avatar"}})])]),r("div",{staticClass:"follower-main"},[r("div",{staticClass:"name"},[e._v(e._s(t.name))]),r("div",{staticClass:"tag-name"},[e._v("@"+e._s(t.account))]),r("div",{staticClass:"description scrollbar"},[e._v(" "+e._s(t.introduction)+" ")])]),t.isFollowed?r("button",{staticClass:"follower-btn following",attrs:{disabled:e.isProcessing},on:{click:function(r){return e.removeFollow(t)}}},[e._v(" 正在跟隨 ")]):r("button",{staticClass:"follower-btn",attrs:{disabled:e.isProcessing},on:{click:function(r){return e.addFollow(t)}}},[e._v(" 跟隨 ")])])})),0)])],1),r("UserRightColumn",{attrs:{initialTopUsers:e.topUsers},on:{"add-follow-click":e.followClicked,"remove-follow-click":e.followClicked}})],1)])},o=[],n=r("1da1"),a=r("5530"),i=(r("96cf"),r("a9e3"),r("d81d"),r("232c")),l=r("b12b"),c=r("3e69"),u=r("99f5"),d=r("2375"),f=r("4cce"),w=r("7482"),p=r("2fa3"),v=r("2f62"),m=r("2708"),g={mixins:[m["b"],m["a"]],components:{UserLeftColumn:i["a"],UserRightColumn:l["a"],UserHeader:c["a"],UserFollowTab:u["a"],Spinner:d["a"]},data:function(){return{isLoading:!0,userId:Number(this.$route.params.id),currentUserId:-1,user:{},topUsers:{},followers:[],isProcessing:!1}},created:function(){this.fetchFollower(this.userId),this.fetchUserInfo(this.userId),this.fetchTopUsers()},computed:Object(a["a"])({},Object(v["b"])(["currentUser","isAuthenticated"])),beforeRouteUpdate:function(e,t,r){console.log(e,t);var s=e.params.id;this.fetchFollower(s),this.userId=Number(s),r()},methods:{fetchFollower:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isLoading=!0,r.next=4,f["a"].getUserFollowers({userId:e});case 4:s=r.sent,o=s.data,t.followers=o,t.isLoading=!1,r.next=14;break;case 10:r.prev=10,r.t0=r["catch"](0),console.log(r.t0),t.isLoading=!1,p["a"].fire({icon:"error",title:"無法取得個人資料，請稍後再試"});case 14:case"end":return r.stop()}}),r,null,[[0,10]])})))()},fetchUserInfo:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isLoading=!0,r.next=4,f["a"].get({userId:e});case 4:s=r.sent,o=s.data,t.user=o,t.isLoading=!1,r.next=13;break;case 10:r.prev=10,r.t0=r["catch"](0),t.isLoading=!1,p["a"].fire({icon:"error",title:"無法取得個人資料，請稍後再試"});case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},fetchTopUsers:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,w["a"].getTopUser();case 3:r=t.sent,s=r.data,e.topUsers=s,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),p["a"].fire({icon:"warning",title:"無法取得前十"});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},addFollow:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,o,n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s=e.followerId,o='{\n        "id":"'.concat(s,'"\n      }'),n=JSON.parse(o),r.prev=3,t.isProcessing=!0,r.next=7,w["a"].addFollow({data_JSON:n});case 7:a=r.sent,console.log("popular response",a),e.isFollowed=!0,t.topUsers.map((function(e){s===e.id&&s===e.id&&(e.isFollowed=!0)})),t.isProcessing=!1,r.next=18;break;case 14:r.prev=14,r.t0=r["catch"](3),t.isProcessing=!1,p["a"].fire({icon:"error",title:"無法追蹤使用者,請稍後"});case 18:case"end":return r.stop()}}),r,null,[[3,14]])})))()},removeFollow:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,o,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s=e.followerId,console.log(s),r.prev=2,t.isProcessing=!0,r.next=6,w["a"].removeFollow({userId:s});case 6:if(o=r.sent,console.log("reponse",o),n=o.data,"success"===n.status){r.next=11;break}throw new Error(n.message);case 11:t.followers=t.followers.map((function(e){return e.id!==s?e:Object(a["a"])(Object(a["a"])({},e),{},{isfollowered:!1})})),e.isFollowed=!1,t.topUsers.map((function(e){s===e.id&&s===e.id&&(e.isFollowed=!1)})),t.isProcessing=!1,r.next=22;break;case 17:r.prev=17,r.t0=r["catch"](2),t.isProcessing=!1,console.log(r.t0),p["a"].fire({icon:"error",title:"無法取消喜歡,請稍後在試"});case 22:case"end":return r.stop()}}),r,null,[[2,17]])})))()},followClicked:function(e){this.followers.map((function(t){e===t.followerId&&e===t.followerId&&(t.isFollowed=!t.isFollowed)}))}}},h=g,b=(r("f362"),r("2877")),k=Object(b["a"])(h,s,o,!1,null,"15672934",null);t["default"]=k.exports},"99f5":function(e,t,r){"use strict";var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"user-follow-tab"}},[r("router-link",{attrs:{to:{name:"follower"}}},[r("div",{staticClass:"follower tab",class:{clicked:"follower"===this.$route.name}},[e._v("跟隨者")])]),r("router-link",{attrs:{to:{name:"following"}}},[r("div",{staticClass:"following tab",class:{clicked:"following"===this.$route.name}},[e._v("正在跟隨")])])],1)},o=[],n=(r("2889"),r("2877")),a={},i=Object(n["a"])(a,s,o,!1,null,"3472e1b4",null);t["a"]=i.exports},a5fb:function(e,t,r){},f362:function(e,t,r){"use strict";r("a5fb")},f66c:function(e,t,r){}}]);
//# sourceMappingURL=chunk-30d1b367.231c111c.js.map