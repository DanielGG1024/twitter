{"version":3,"sources":["webpack:///./src/views/publicMessage.vue?831c","webpack:///./src/views/publicMessage.vue?35ab","webpack:///./src/components/MessageBox.vue?e139","webpack:///./src/apis/socket.js","webpack:///src/components/MessageBox.vue","webpack:///./src/components/MessageBox.vue?3945","webpack:///./src/components/MessageBox.vue?d2a7","webpack:///src/views/publicMessage.vue","webpack:///./src/views/publicMessage.vue?5eba","webpack:///./src/views/publicMessage.vue?8f34","webpack:///./src/components/MessageBox.vue?0264"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","userId","currentUserId","_v","_s","onlineList","length","_l","onlineUser","key","id","avatar","name","account","staticRenderFns","_m","ref","user","newMessages","newMessage","ChatId","Number","User","text","_f","createdAt","_e","directives","rawName","value","expression","domProps","on","$event","type","indexOf","_k","keyCode","send","apply","arguments","target","composing","isProcessing","preventDefault","stopPropagation","getToken","localStorage","getItem","getHistory","apiHelper","get","headers","Authorization","components","props","Array","required","mixins","data","announceData","created","fetchHistory","$socket","connect","currentUser","console","log","mounted","emit","scrollToBottom","updated","methods","$refs","messageBox","scrollTop","scrollHeight","msg","UserId","computed","sockets","announce","push","date","disconnect","component","UserLeftColumn","MessageBox","$route","params","beforeRouteLeave","next"],"mappings":"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","file":"js/chunk-69fc00a6.a8b3f87a.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./publicMessage.vue?vue&type=style&index=0&id=5822fac9&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"window\"}},[_c('div',{staticClass:\"publicMessage\"},[_c('div',{staticClass:\"menu-container\"},[_c('UserLeftColumn',{attrs:{\"userId\":_vm.userId,\"currentUserId\":_vm.currentUserId}})],1),_c('div',{staticClass:\"user-list\"},[_c('div',{staticClass:\"online online-list\"},[_c('header',[_c('div',{staticClass:\"title\"},[_vm._v(\" 上線使用者 \"),_c('span',{staticClass:\"onlineCount\"},[_vm._v(\"(\"+_vm._s(_vm.onlineList.length)+\")\")])])]),_c('div',{staticClass:\"online-users\"},_vm._l((_vm.onlineList),function(onlineUser){return _c('div',{key:onlineUser.id,staticClass:\"online-user\"},[_c('div',{staticClass:\"avatar\"},[_c('img',{attrs:{\"src\":onlineUser.avatar,\"alt\":\"\"}})]),_c('div',{staticClass:\"user-info\"},[_c('div',{staticClass:\"name\"},[_vm._v(\" \"+_vm._s(onlineUser.name)+\" \")]),_c('div',{staticClass:\"account\"},[_vm._v(\" @ \"+_vm._s(onlineUser.account)+\" \")])])])}),0)])]),_c('div',{staticClass:\"message-box\"},[_c('MessageBox',{attrs:{\"onlineList\":_vm.onlineList}})],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"messageBox\"},[_vm._m(0),_c('div',{ref:\"messageBox\",staticClass:\"messageBox-wrapper\"},[_vm._l((_vm.onlineList),function(user){return _c('div',{key:user.id,staticClass:\"notify\"},[_c('div',{staticClass:\"notify-mgs\"},[_vm._v(_vm._s(user.name)+\"上線\")])])}),(_vm.newMessages.length !== 'undefined')?_vm._l((_vm.newMessages),function(newMessage){return _c('div',{key:newMessage.ChatId},[(Number(newMessage.User.id) !== Number(_vm.userId))?_c('div',{staticClass:\"user-remote\"},[_c('div',{staticClass:\"avatar\"},[_c('div',{staticClass:\"pic\"},[_c('img',{staticClass:\"icon\",attrs:{\"src\":newMessage.User.avatar,\"alt\":\"\"}})])]),_c('div',{staticClass:\"txt-wrapper\"},[_c('div',{staticClass:\"message\"},[_vm._v(\" \"+_vm._s(newMessage.text)+\" \")]),_c('div',{staticClass:\"time\"},[_vm._v(\" \"+_vm._s(_vm._f(\"fromNowWithWord\")(newMessage.createdAt))+\" \")])])]):_c('div',{staticClass:\"user-local\"},[_c('div',{staticClass:\"txt-wrapper\"},[_c('div',{staticClass:\"message\"},[_vm._v(\" \"+_vm._s(newMessage.text)+\" \")]),_c('div',{staticClass:\"time\"},[_vm._v(\" \"+_vm._s(_vm._f(\"fromNowWithWord\")(newMessage.createdAt))+\" \")])])])])}):_vm._e()],2),_c('div',{staticClass:\"input-area\",attrs:{\"id\":\"textArea\"}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.text),expression:\"text\"}],attrs:{\"name\":\"\",\"type\":\"text\",\"placeholder\":\"輸入訊息...\"},domProps:{\"value\":(_vm.text)},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.send.apply(null, arguments)},\"input\":function($event){if($event.target.composing){ return; }_vm.text=$event.target.value}}}),_c('button',{staticClass:\"btn\",attrs:{\"disabled\":_vm.isProcessing},on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.send.apply(null, arguments)}}},[_c('i',{staticClass:\"bx bx-right-arrow\"})])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"header\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"公開聊天室\")])])}]\n\nexport { render, staticRenderFns }","import { apiHelper } from \"../utils/helpers\";\nconst getToken = () => localStorage.getItem('token')\nexport default {\n  getHistory() {\n    return apiHelper.get('chatroom/getHistoryMsg', {\n      headers: {\n        Authorization: `Bearer ${getToken()}`\n      }\n    })\n  },\n}","<template>\n  <div class=\"messageBox\">\n    <div class=\"header\">\n      <div class=\"title\">公開聊天室</div>\n    </div>\n    <div class=\"messageBox-wrapper\" ref=\"messageBox\">\n      <div v-for=\"user in onlineList\" :key=\"user.id\" class=\"notify\">\n        <div class=\"notify-mgs\">{{ user.name }}上線</div>\n      </div>\n      <template v-if=\"newMessages.length !== 'undefined'\">\n        <div v-for=\"newMessage in newMessages\" :key=\"newMessage.ChatId\">\n          <div\n            v-if=\"Number(newMessage.User.id) !== Number(userId)\"\n            class=\"user-remote\"\n          >\n            <div class=\"avatar\">\n              <div class=\"pic\">\n                <img class=\"icon\" :src=\"newMessage.User.avatar\" alt=\"\" />\n              </div>\n            </div>\n            <div class=\"txt-wrapper\">\n              <div class=\"message\">\n                {{ newMessage.text }}\n              </div>\n              <div class=\"time\">\n                {{ newMessage.createdAt | fromNowWithWord }}\n              </div>\n            </div>\n          </div>\n\n          <div v-else class=\"user-local\">\n            <div class=\"txt-wrapper\">\n              <div class=\"message\">\n                {{ newMessage.text }}\n              </div>\n              <div class=\"time\">\n                {{ newMessage.createdAt | fromNowWithWord }}\n              </div>\n            </div>\n          </div>\n        </div>\n      </template>\n    </div>\n\n    <div class=\"input-area\" id=\"textArea\">\n      <input\n        name=\"\"\n        v-model=\"text\"\n        type=\"text\"\n        placeholder=\"輸入訊息...\"\n        @keyup.enter=\"send\"\n      />\n      <button @click.prevent.stop=\"send\" class=\"btn\" :disabled=\"isProcessing\">\n        <i class=\"bx bx-right-arrow\"></i>\n      </button>\n    </div>\n  </div>\n</template>\n\n\n<script>\nimport { Toast } from \"./../utils/helpers\";\nimport socketAPI from \"./../apis/socket\";\nimport { fromNowFilter } from \"./../utils/mixins\";\nimport { mapState } from \"vuex\";\nexport default {\n  name: \"messageBox\",\n  components: {\n    // PerfectScrollbar,\n  },\n  props: {\n    onlineList: {\n      type: Array,\n      required: false,\n    },\n  },\n  mixins: [fromNowFilter],\n  data() {\n    return {\n      userId: -1,\n      text: \"\",\n      newMessages: [],\n      announceData: \"\",\n      isProcessing: false,\n    };\n  },\n  created() {\n    this.fetchHistory();\n    this.$socket.connect();\n    this.userId = this.currentUser.id;\n    const userId = this.currentUser.id;\n    console.log(userId);\n  },\n  mounted() {\n    const userId = this.currentUser.id;\n    this.$socket.emit(\"leave\");\n    this.$socket.emit(\"joinPublic\", userId);\n    this.scrollToBottom();\n  },\n  updated() {\n    this.scrollToBottom();\n  },\n  methods: {\n    scrollToBottom() {\n      this.$refs.messageBox.scrollTop = this.$refs.messageBox.scrollHeight;\n    },\n    send() {\n      this.isProcessing = true;\n      const userId = this.currentUser.id;\n      const text = this.text.trim();\n      console.log(text);\n      if (text.length === 0) return;\n      this.$socket.emit(\"chatmessage\", {\n        msg: text,\n        UserId: userId,\n      });\n      this.text = \"\";\n      this.isProcessing = false;\n    },\n    async fetchHistory() {\n      try {\n        const { data } = await socketAPI.getHistory();\n        console.log(data);\n        this.newMessages = data;\n        this.scrollToBottom();\n      } catch {\n        Toast.fire({\n          icon: \"error\",\n          title: \"無法取的歷史訊息\",\n        });\n      }\n    },\n  },\n  computed: {\n    ...mapState([\"currentUser\", \"isAuthenticated\"]),\n  },\n  sockets: {\n    connect: function () {\n      console.log(\"connect\");\n      const userId = this.currentUser.id;\n      this.$socket.emit(\"joinPublic\", userId);\n    },\n    announce: function (data) {\n      console.log(\"announce data:\", data);\n    },\n    newMessage: function (data) {\n      console.log(\"newMessage data:\", data);\n      this.newMessages.push({\n        User: {\n          id: data.user.id,\n          avatar: data.user.avatar,\n          name: data.user.name,\n          account: data.user.account,\n        },\n        text: data.msg,\n        createdAt: data.date,\n      });\n    },\n    disconnect: function () {\n      console.log(\"disconnect\");\n      const userId = this.currentUser.id;\n      this.$socket.emit(\"leavePublic\", userId);\n    },\n  },\n};\n</script>\n\n\n<style lang=\"scss\" scoped>\n@import \"./../assets/scss/messageBox.scss\";\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MessageBox.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MessageBox.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MessageBox.vue?vue&type=template&id=05263906&scoped=true&\"\nimport script from \"./MessageBox.vue?vue&type=script&lang=js&\"\nexport * from \"./MessageBox.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MessageBox.vue?vue&type=style&index=0&id=05263906&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"05263906\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"window\">\n    <div class=\"publicMessage\">\n      <!-- Menu -->\n      <div class=\"menu-container\">\n        <UserLeftColumn :userId=\"userId\" :currentUserId=\"currentUserId\" />\n      </div>\n      <!-- userList  -->\n      <div class=\"user-list\">\n        <div class=\"online online-list\">\n          <header>\n            <div class=\"title\">\n              上線使用者\n              <span class=\"onlineCount\">({{ onlineList.length }})</span>\n            </div>\n          </header>\n          <div class=\"online-users\">\n            <div\n              class=\"online-user\"\n              v-for=\"onlineUser in onlineList\"\n              :key=\"onlineUser.id\"\n            >\n              <div class=\"avatar\">\n                <img :src=\"onlineUser.avatar\" alt=\"\" />\n              </div>\n              <div class=\"user-info\">\n                <div class=\"name\">\n                  {{ onlineUser.name }}\n                </div>\n                <div class=\"account\">\n                  @\n                  {{ onlineUser.account }}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <!-- messageBox -->\n      <div class=\"message-box\">\n        <MessageBox :onlineList=\"onlineList\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport UserLeftColumn from \"../components/UserLeftColumn.vue\";\n\nimport MessageBox from \"./../components/MessageBox.vue\";\nimport { mapState } from \"vuex\";\n\nexport default {\n  name: \"publicMessage\",\n  components: {\n    UserLeftColumn,\n    MessageBox,\n  },\n  data() {\n    return {\n      userId: Number(this.$route.params.id),\n      currentUserId: -1,\n      onlineList: [],\n    };\n  },\n  created() {\n    this.currentUserId = this.currentUser.id;\n  },\n  mounted() {\n    const userId = this.currentUser.id;\n    this.$socket.emit(\"leave\");\n    this.$socket.emit(\"joinPublic\", userId);\n  },\n  sockets: {\n    connect: function () {\n      console.log(\"socket connected\");\n    },\n    onlineList: function (data) {\n      console.log(\"public-onlineList\", data);\n      this.onlineList = data;\n    },\n    announce: function (data) {\n      console.log(\"announce data:\", data);\n    },\n    // disconnect: function () {\n    //   console.log(\"disconnect\");\n    //   const userId = this.currentUser.id;\n    //   this.$socket.emit(\"leavePublic\", userId);\n    // },\n  },\n  beforeRouteLeave(to, from, next) {\n    const userId = this.currentUser.id;\n    this.$socket.emit(\"leavePublic\", userId);\n    next();\n  },\n  computed: {\n    ...mapState([\"currentUser\", \"isAuthenticated\"]),\n  },\n};\n</script>\n\n\n\n<style lang=\"scss\" scoped>\n@import \"./../assets/scss/publicMessage.scss\";\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./publicMessage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./publicMessage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./publicMessage.vue?vue&type=template&id=5822fac9&scoped=true&\"\nimport script from \"./publicMessage.vue?vue&type=script&lang=js&\"\nexport * from \"./publicMessage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./publicMessage.vue?vue&type=style&index=0&id=5822fac9&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5822fac9\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MessageBox.vue?vue&type=style&index=0&id=05263906&lang=scss&scoped=true&\""],"sourceRoot":""}