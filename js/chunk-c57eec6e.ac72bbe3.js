(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c57eec6e"],{2085:function(t,e,s){},"6fc2":function(t,e,s){},7702:function(t,e,s){"use strict";s("6fc2")},a03b:function(t,e,s){"use strict";s("f622")},cd56:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main"},[s("div",{staticClass:"main-container"},[s("Menu",{on:{"after-tweet-post":t.afterTweetPost}}),s("main",{staticClass:"content"},[s("div",{staticClass:"content-post"},[t._m(0),s("MainTweetPost",{on:{"after-tweet-post":t.afterTweetPost}})],1),t.isLoading?s("Spinner"):s("MainTweets",{attrs:{allTweets:t.allTweets},on:{"after-tweetReply-post":t.afterTweetPost}})],1),s("Popular")],1)])},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content-header"},[s("span",{staticClass:"title"},[t._v("首頁")])])}],i=s("1da1"),r=(s("96cf"),s("fb62")),o=s("3b8f"),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main-tweet"},[s("div",{staticClass:"user-icon-wrapper"},[s("img",{staticClass:"user-icon",attrs:{src:t.currentUser.avatar,alt:""}})]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.mainTweetPost,expression:"mainTweetPost"}],staticClass:"main-tweet-txt",attrs:{name:"",id:"",value:"hello",placeholder:"有甚麼新鮮事?"},domProps:{value:t.mainTweetPost},on:{input:function(e){e.target.composing||(t.mainTweetPost=e.target.value)}}}),s("button",{staticClass:"main-tweet-button",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.handleSubmit.apply(null,arguments)}}},[t._v(" 推文 ")]),s("p")])},l=[],u=s("2fa3"),d=s("7482"),f=s("2f62"),w={name:"MainTweetPost",data(){return{mainTweetPost:"",avatar:""}},computed:{...Object(f["b"])(["currentUser","isAuthenticated"])},methods:{async handleSubmit(){const t=this.mainTweetPost;if(t.trim().length<1)u["a"].fire({icon:"warning",title:"內容不能為空白"});else if(t.length>140)u["a"].fire({icon:"warning",title:"內容不能超過140個字"});else try{const e=`{\n          "description":"${t}"\n        }`,s=JSON.parse(e),a=await d["a"].postTweet({data_JSON:s});if(console.log("maintweetpost"),"success"!==a.data.status)throw new Error;u["a"].fire({icon:"success",title:"發送成功!"}),this.$emit("after-tweet-post"),this.mainTweetPost=""}catch{u["a"].fire({icon:"error",title:"無法送出推文,請稍後"})}}}},p=w,m=(s("a03b"),s("2877")),v=Object(m["a"])(p,c,l,!1,null,"580c499e",null),h=v.exports,g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"chat",staticClass:"tweets scrollbar"},[t._l(t.allTweets,(function(e){return a("div",{key:e.TweetId,staticClass:"onetweet"},[a("div",{staticClass:"onetweet-user-icon-wrapper"},[a("router-link",{attrs:{to:{name:"user",params:{id:e.User.id}}}},[a("img",{staticClass:"user-icon",attrs:{src:e.User.avatar,alt:""}})])],1),a("div",{staticClass:"onetweet-txt-wrapper"},[a("div",{staticClass:"onetweet-txt-header"},[a("router-link",{attrs:{to:{name:"Reply",params:{id:e.TweetId}}}},[a("span",{staticClass:"user-title"},[t._v(t._s(e.User.name))]),a("span",{staticClass:"user-info"},[a("a",{staticClass:"user-link",attrs:{href:"#"}},[t._v(" ＠"+t._s(e.User.account))]),a("span",{staticClass:"user-link-time"},[t._v("．"+t._s(t._f("fromNow")(e.createdAt)))])])])],1),a("router-link",{attrs:{to:{name:"Reply",params:{id:e.TweetId}}}},[a("div",{staticClass:"onetweet-txt"},[t._v(" "+t._s(e.description)+" ")])]),a("div",{staticClass:"onetweet-footer"},[a("div",{staticClass:"chat"},[a("div",{staticClass:"onetweet-footer-icon"},[a("img",{staticClass:"chat-icon",attrs:{src:s("b74f"),alt:""},on:{click:function(s){return t.clickChatBtn(e.TweetId)}}})]),a("span",{staticClass:"footer-amount"},[t._v(t._s(e.RepliesCount))])]),a("div",{staticClass:"heart"},[a("div",{staticClass:"onetweet-footer-icon"},[e.isLiked?a("img",{staticClass:"heart-icon",attrs:{src:s("4167"),alt:"heart-icon",disabled:t.isProcessing},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.removeLike(e)}}}):a("img",{staticClass:"heart-icon",attrs:{src:s("b4af"),alt:"heart-icon",disabled:t.isProcessing},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.addLike(e)}}})]),a("span",{staticClass:"footer-amount"},[t._v(t._s(e.LikesCount))])])])],1)])})),a("ReplyModal",{attrs:{ReplyModalSwitch:t.ReplyModal,tweet:t.tweet},on:{"after-click-background":t.afterClickClose,"after-click-close":t.afterClickClose,"after-tweetReply-post":t.afterTweetReplyPost}})],2)},C=[],k=(s("7db0"),s("2797")),T=s("2708"),b={name:"MainTweets",mixins:[T["b"]],components:{ReplyModal:k["a"]},props:{allTweets:{type:Array,require:!0}},data:function(){return{ReplyModal:!1,tweet:{User:{avatar:""}},isProcessing:!1}},methods:{clickChatBtn:function(t){this.ReplyModal=!0,this.tweet=this.allTweets.find((function(e){return e.TweetId===t}))},afterClickClose:function(){this.ReplyModal=!1},afterTweetReplyPost:function(){this.ReplyModal=!1,this.$emit("after-tweetReply-post")},addLike:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var a,n,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return console.log("tweet",t),s.prev=1,e.isProcessing=!0,a=t.TweetId,s.next=6,d["a"].addLike({tweetId:a});case 6:if(n=s.sent,i=n.data,console.log("add data",i),"success"===i.status){s.next=11;break}throw new Error(i.message);case 11:t.LikesCount+=1,t.isLiked=!0,e.isProcessing=!1,s.next=21;break;case 16:s.prev=16,s.t0=s["catch"](1),e.isProcessing=!1,console.log(s.t0),u["a"].fire({icon:"error",title:"無法喜歡,請稍後在試"});case 21:case"end":return s.stop()}}),s,null,[[1,16]])})))()},removeLike:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var a,n,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return console.log("tweet",t),s.prev=1,e.isProcessing=!0,a=t.TweetId,s.next=6,d["a"].removeLike({tweetId:a});case 6:if(n=s.sent,console.log("delete reponse",n),i=n.data,"success"===i.status){s.next=11;break}throw new Error(i.message);case 11:t.isLiked=!1,t.LikesCount-=1,e.isProcessing=!1,s.next=21;break;case 16:s.prev=16,s.t0=s["catch"](1),e.isProcessing=!1,console.log(s.t0),u["a"].fire({icon:"error",title:"無法取消喜歡,請稍後在試"});case 21:case"end":return s.stop()}}),s,null,[[1,16]])})))()}}},P=b,_=(s("7702"),Object(m["a"])(P,g,C,!1,null,"48b0a606",null)),R=_.exports,x=s("2375"),y={namd:"main",components:{Menu:r["a"],Popular:o["a"],MainTweetPost:h,MainTweets:R,Spinner:x["a"]},data:function(){return{isLoading:!0,allTweets:[],tweet:{}}},created:function(){this.fetchTweets()},methods:{fetchTweets:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d["a"].getTweets();case 3:s=e.sent,a=s.data,t.allTweets=a,t.isLoading=!1,e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](0),t.isLoading=!1,u["a"].fire({icon:"warning",title:"tweets錯誤唷"});case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))()},afterTweetPost:function(){this.fetchTweets()}}},L=y,M=(s("fe02"),Object(m["a"])(L,a,n,!1,null,"0bb9981e",null));e["default"]=M.exports},f622:function(t,e,s){},fe02:function(t,e,s){"use strict";s("2085")}}]);
//# sourceMappingURL=chunk-c57eec6e.ac72bbe3.js.map